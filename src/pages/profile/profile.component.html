<!-- profile.component.html -->
<form [formGroup]="profileForm" class="user-profile-form">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card profile-card shadow">
                <div class="card-header bg-primary text-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <h3 class="mb-0">
                            <i class="fas fa-user-circle me-2"></i>Thông tin cá nhân
                        </h3>
                        <button type="button" class="btn btn-sm btn-light" (click)="backToProfile()">
                            <i class="fas fa-times me-1"></i>Đóng
                        </button>
                    </div>
                </div>

                <div class="card-body p-4">
                    <!-- Avatar Section -->
                    <div class="text-center mb-4">
                        <div class="avatar-wrapper">
                            <img src="/src/assets/images/Image_profile.png" alt="Avatar" class="avatar-img rounded-circle">
                            <button class="btn btn-sm btn-outline-primary avatar-upload-btn">
                                <i class="fas fa-camera"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Form Fields -->
                    <div class="form-section">
                        <h5 class="section-title"><i class="fas fa-info-circle me-2"></i>Thông tin cơ bản</h5>

                        <div class="mb-3">
                            <label for="fullname" class="form-label">Họ và tên <span
                                    class="text-danger">*</span></label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-user"></i></span>
                                <input type="text" formControlName="fullname" class="form-control" id="fullname"
                                    placeholder="Nhập họ và tên"
                                    [class.is-invalid]="profileForm.get('fullname')!.invalid && profileForm.get('fullname')!.touched">
                            </div>
                            @if(profileForm.get('fullname')!.invalid && profileForm.get('fullname')!.touched) {
                            <div class="invalid-feedback d-block">
                                <i class="fas fa-exclamation-circle me-1"></i> Họ và tên là trường bắt buộc
                            </div>
                            }
                        </div>

                        <div class="mb-3">
                            <label for="date_of_birth" class="form-label">Ngày sinh</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                                <input type="date" formControlName="date_of_birth" class="form-control"
                                    id="date_of_birth">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="address" class="form-label">Địa chỉ</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                                <input type="text" formControlName="address" class="form-control" id="address"
                                    placeholder="Nhập địa chỉ"
                                    [class.is-invalid]="profileForm.get('address')!.invalid && profileForm.get('address')!.touched">
                            </div>
                        </div>
                    </div>

                    <!-- Password Section -->
                    <div class="form-section mt-4">
                        <h5 class="section-title"><i class="fas fa-lock me-2"></i>Thay đổi mật khẩu</h5>
                        <p class="text-muted small mb-3">Chỉ điền thông tin nếu bạn muốn thay đổi mật khẩu</p>

                        <div class="mb-3">
                            <label for="password" class="form-label">Mật khẩu mới</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-key"></i></span>
                                <input type="password" class="form-control" formControlName="password"
                                    placeholder="Nhập mật khẩu mới" id="password"
                                    [class.is-invalid]="profileForm.get('password')!.invalid && profileForm.get('password')!.touched">
                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            @if(profileForm.get('password')!.invalid && profileForm.get('password')!.touched) {
                            <div class="invalid-feedback d-block">
                                <i class="fas fa-exclamation-circle me-1"></i> Mật khẩu ít nhất 3 ký tự
                            </div>
                            }
                        </div>

                        <div class="mb-3">
                            <label for="retype_password" class="form-label">Nhập lại mật khẩu</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-key"></i></span>
                                <input type="password" class="form-control" formControlName="retype_password"
                                    placeholder="Nhập lại mật khẩu" id="retype_password"
                                    [class.is-invalid]="(profileForm.get('retype_password')!.invalid || profileForm.hasError('passwordMismatch')) && profileForm.get('retype_password')!.touched">
                                <button class="btn btn-outline-secondary toggle-password" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            @if(profileForm.hasError('passwordMismatch')) {
                            <div class="invalid-feedback d-block">
                                <i class="fas fa-exclamation-circle me-1"></i> Mật khẩu không khớp
                            </div>
                            }
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex justify-content-between mt-4">
                        <button type="button" class="btn btn-outline-secondary" (click)="backToProfile()">
                            <i class="fas fa-arrow-left me-2"></i>Quay lại
                        </button>
                        <button type="button" (click)="save()" class="btn btn-primary save-btn"
                            [disabled]="profileForm.invalid">
                            <i class="fas fa-save me-2"></i>Lưu thay đổi
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>